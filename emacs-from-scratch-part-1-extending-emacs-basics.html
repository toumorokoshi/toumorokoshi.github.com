<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Emacs From Scratch, Part 1: Extending Emacs basics</title>
        <link rel="stylesheet" href="./theme/css/main.css" />
        <link href="http://y.tsutsumi.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="y.tsutsumi.io Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="./">y.tsutsumi.io </a></h1>
                <nav><ul>
                    <li><a href="/category/programming.html">Just Programming Posts</a></li>
                    <li><a href="/codersguide/">Coder's Guide</a></li>
                    <li><a href="https://nbviewer.jupyter.org/github/toumorokoshi/notebooks/tree/master/">Notebooks</a></li>
                    <li><a href="./pages/about-me.html">About Me</a></li>
                    <li><a href="./pages/projects.html">Projects</a></li>
                    <li><a href="./pages/resources.html">Resources</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="./emacs-from-scratch-part-1-extending-emacs-basics.html" rel="bookmark"
           title="Permalink to Emacs From Scratch, Part 1: Extending Emacs basics">Emacs From Scratch, Part 1: Extending Emacs basics</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-01-22T00:00:00+01:00">
                Published: Wed 22 January 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="./author/yusuke-tsutsumi.html">Yusuke Tsutsumi</a>
        </address>
<p>In <a href="./category/programming.html">programming</a>.</p>
<p>tags: <a href="./tag/emacs.html">emacs</a> <a href="./tag/environment.html">environment</a> </p>
</footer><!-- /.post-info -->      <p>This is a series of tutorials geared around building up your own
customized environment, using emacs, from scratch.</p>
<p>You can find <a class="reference external" href="emacs-from-scratch-part-2-package-management.html">part 2 here</a>
You can find <a class="reference external" href="emacs-from-scratch-part-3-extending-emacs-with-elisp.html">part 3 here</a></p>
<p>This tutorial is geared toward those who are starting with extending
Emacs, and want to learn the pieces you need to know to really extend
and build your custom environment. If you want to just get started
with a rocking environment and don't care about understanding the
nitty-gritty, I'd suggest looking at <a class="reference external" href="https://github.com/bbatsov/prelude">emacs-prelude</a></p>
<p>We're going to go in-depth on discussing the following topics:</p>
<ul class="simple">
<li>extending your base emacs with init-files, and some good practices there</li>
<li>managing and installing packages, and doing so automatically</li>
<li>binding command and keys to installed packages</li>
<li>writing some custom code, and integrating it into your emacs environment</li>
</ul>
<p>If you follow all these tutorials word for word, you'll end up with
the building blocks to set up your own personalized emacs environment. Here's mine:</p>
<p><a class="reference external" href="http://www.youtube.com/watch?v=8vdOrsywra0">My Emacs Setup</a></p>
<p>However, I would recommend picking and choosing the parts that best
suit your purposes. Please leave comments if I'm not going in-depth
enough to provide the tools to do so.</p>
<p>So let's begin!</p>
<div class="section" id="the-tutorial">
<h2>The Tutorial</h2>
<div class="section" id="emacs-lisp">
<h3>Emacs Lisp</h3>
<p>To follow these tutorials, you need to have a very rudimentary
understanding of emacs lisp. Basically just remeber this:</p>
<pre class="literal-block">
(method arg1 arg2 ...)
</pre>
<p>Is how methods are called: the first element in a parentheses is the
method being called, and the subsequent elements are it's arguments.</p>
<p>You can also nest calls into calls, like this:</p>
<pre class="literal-block">
(foo (bar bar-argument) foo-argument)
</pre>
<p>This nesting of statements is what starts the chain of parentheses
that lisp and lisp dialects are famous for.</p>
</div>
<div class="section" id="init-files">
<h3>Init-Files</h3>
<p>init-files are the files that emacs loads on startup. This is similar
to the rc files that you often see with shells/terminals, vim, or a
variety of other tools.</p>
<p>Emacs has a few standard places to add an init-file, but those are
already well documented in the <a class="reference external" href="http://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html">manual</a>.
If you want to know more, feel free to read there.</p>
<p>For the most part, however, there are two main locations where
init-files lie: the .emacs file and the .emacs.d directory in the user
root.</p>
<p>Unlike some other init files, Emacs's initialization is basically
evaluating the init-files with it's built-in elisp (Emacs Lisp)
interpreter. This is what provides Emacs users with real power: since
the great majority of Emacs is written directly in elisp, it is
possible to extend any of that code with your init-file, or even
evaluating code on the fly after the system starts up. This is a stark
contrast to other extensibile architectures, which only allow a
discrete set of configs or apis from which to modify application
behaviour. When you hear someone say Emacs is &quot;infinitely extensible&quot;,
this is what they mean: you can practically modify whatever you want
in Emacs!</p>
<p>But before we get to this awesome power, it's first best to learn some
ways to organize your init-files. Emacs init-files can get huge, and
having good practices now will help you manage all the pieces in the long run.</p>
<p>The .emacs.d directory is the de-facto place to store configuration
files beyond the .emacs file. Package managers add their packages
there, packages add their configuration there, so it's also a good
place to add our custom configuration.</p>
<p>For our example, let's disable the menu, scroll and tool bars. This
removes all of the dropdown gui menus, so all we have are the buffers
left. You might think this is crippling at first, but learning your keybindings
will make you way more efficient in the long run.</p>
<p>You can name your files whatever you want, but I've found it's easy to
find files if you prefix them. I prefix all of my init-files with
&quot;my-&quot;. This also has the advantage of signifying it's a personal
configuration.</p>
<p>So let's make a file now called &quot;my-noexternals&quot;. This signifies to me
that these are configs for components that are native to Emacs (don't
depend on third-party packages, or &quot;externals&quot;). Let's disable the menu, tool, and
scroll bar now:</p>
<pre class="literal-block">
; ~/.emacs.d/my-noexternals.el

;; Remove scrollbars, menu bars, and toolbars
; when is a special form of &quot;if&quot;, with no else clause, it reads:
; (when &lt;condition&gt; &lt;code-to-execute-1&gt; &lt;code-to-execute2&gt; ...)
(when (fboundp 'menu-bar-mode) (menu-bar-mode -1))
(when (fboundp 'tool-bar-mode) (tool-bar-mode -1))
(when (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))
</pre>
<p>Now that we have that, we need to load our my-noexternals.el file in
our .emacs. Add the following line to ~/.emacs:</p>
<pre class="literal-block">
; ~/.emacs
(load &quot;~/.emacs.d/my-noexternals.el&quot;)
</pre>
<p>And now when you start emacs, you'll have the bars disabled! Of
course, you're welcome to enable whatever you like, I was just using
this as an example.</p>
</div>
<div class="section" id="rebinding-keys">
<h3>Rebinding Keys</h3>
<p>Now let's say we want to re-bind keys. elisp has a command for that as
well, and it's called global-set-key. It works like this:</p>
<pre class="literal-block">
(global-set-key &lt;keychord&gt; &lt;function-name&gt;)
</pre>
<p>An easy way to declare the key chord you want to use is by using the
&quot;kbd&quot; command, which evaluates a keychord formatted in typical emacs
key-chord fashion, and evaluates it to something global-set-key can
understand. As an example:</p>
<pre class="literal-block">
(global-set-key (kbd &quot;C-c C-j&quot;) 'foo)
</pre>
<p>Would make C-c C-j (&lt;Ctrl + c&gt; followed by &lt;Ctrl + j&gt;) run the &quot;foo&quot; function.</p>
<p>As a personal preference, I like
navigating through my open windows with vim-like movement (hjkl). As a
compromise, I bind the following commands:</p>
<pre class="literal-block">
; ~/my-noexternals.el

;; Wind-move

(global-set-key (kbd &quot;C-c C-j&quot;) 'windmove-left)
(global-set-key (kbd &quot;C-c C-k&quot;) 'windmove-down)
(global-set-key (kbd &quot;C-c C-l&quot;) 'windmove-up)
(global-set-key (kbd &quot;C-c C-;&quot;) 'windmove-right)
</pre>
<p>windmove-&lt;direction&gt; is a command that moves your window focus to the
first window in the direction specified. I bind them to the chords C-c
C-(jkl;), because C-c C-h is a help command.</p>
</div>
<div class="section" id="using-hooks">
<h3>Using Hooks</h3>
<p>However, the problem with some keybindings is that they get overridden
depending on the order global-set-key gets run. This is especially a
problem when using external packages, which can sometimes override
keys with their own configuration. This is not a common practice now,
but can still happend.</p>
<p>To help ensure your commands run in a particular order, Emacs provides
hooks into it's startup (along with several other places, but we'll
get into that later). So let's modify our .emacs so my-noexternals.el
gets loaded at the very end, after everything else has run:</p>
<pre class="literal-block">
; ~/.emacs

(add-hook 'after-init-hook '(lambda ()
  (load &quot;~/.emacs.d/my-noexternals.el&quot;)
))
</pre>
<p>The &quot;add-hook&quot; command allows you to hook methods to run at a
particular time, and the &quot;'after-init-hook&quot; tells emacs to run the
method after everything else in the init-file loaded.</p>
<p>Note that in this example, I used a lambda/anonymous method versus an
explicit function. It's typically the standard to do lambdas in hooks
over, say, defining a function and passing it.</p>
</div>
<div class="section" id="summary">
<h3>Summary</h3>
<p>So to recap, here's the useful things we learned:</p>
<ul class="simple">
<li>~/.emacs and ~/.emacs.d/ are the standard locations to add init-files</li>
<li>splitting out ~/.emacs into several other files and loading those is a lot easier to manage</li>
<li>(load &lt;filename&gt;) will evaluate a file</li>
<li>(global-set-key &lt;keychord&gt; &lt;function-name&gt;) will set &lt;keychord&gt; to run &lt;function-name&gt;</li>
<li>(add-hook &lt;hook&gt; &lt;lambda&gt;) to run lambda at a particular event</li>
<li>the &quot;'after-init-hook&quot; event will run functions after the rest of the init-file has finished loading.</li>
</ul>
</div>
<div class="section" id="final-code">
<h3>Final Code</h3>
<p>.emacs:</p>
<pre class="literal-block">
(add-hook 'after-init-hook '(lambda ()
  (load &quot;~/.emacs.d/my-noexternals.el&quot;)
))
</pre>
<p>.emacs.d/my-noexternals.el:</p>
<pre class="literal-block">
; ~/.emacs.d/my-noexternals.el

;; Remove scrollbars, menu bars, and toolbars
(when (fboundp 'menu-bar-mode) (menu-bar-mode -1))
(when (fboundp 'tool-bar-mode) (tool-bar-mode -1))
(when (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))

;; Wind-move
(global-set-key (kbd &quot;C-c C-j&quot;) 'windmove-left)
(global-set-key (kbd &quot;C-c C-k&quot;) 'windmove-down)
(global-set-key (kbd &quot;C-c C-l&quot;) 'windmove-up)
(global-set-key (kbd &quot;C-c C-;&quot;) 'windmove-right)
</pre>
</div>
<div class="section" id="what-s-next">
<h3>What's Next</h3>
<p>Next tutorial, we'll talk about package management.
You can find part 2 <a class="reference external" href="emacs-from-scratch-part-2-package-management.html">here</a></p>
</div>
<div class="section" id="further-reading-references">
<h3>Further Reading / References</h3>
<ul class="simple">
<li><a class="reference external" href="http://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html">init-file</a></li>
<li><a class="reference external" href="http://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html">hooks</a></li>
<li><a class="reference external" href="http://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Commands.html">keybindings</a></li>
<li><a class="reference external" href="http://www.emacswiki.org/emacs/WindMove">windmove</a></li>
</ul>
</div>
</div>

    </div><!-- /.entry-content -->
    <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'tsutsumi';
        var disqus_identifier = 'emacs-from-scratch-part-1-extending-emacs-basics.html';
        var disqus_url = './emacs-from-scratch-part-1-extending-emacs-basics.html';
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//tsutsumi.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://y.tsutsumi.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://github.com/toumorokoshi">GitHub</a></li>
                            <li><a href="https://twitter.com/tsutsumiyusuke">Twitter</a></li>
                            <li><a href="http://www.linkedin.com/profile/view?id=56043626">LinkedIn</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-29270527-2', 'auto');
    ga('send', 'pageview');
    </script>
<script type="text/javascript">
    var disqus_shortname = 'tsutsumi';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>