<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Setting up a streaming gaming Ubuntu PC for sunshine/moonlight | Yusuke Tsutsumi</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Setting up a streaming gaming Ubuntu PC for sunshine/moonlight" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Setting up a streaming gaming Ubuntu PC for moonlight" />
<meta property="og:description" content="Setting up a streaming gaming Ubuntu PC for moonlight" />
<link rel="canonical" href="https://y.tsutsumi.io/ubuntu-sunshine/" />
<meta property="og:url" content="https://y.tsutsumi.io/ubuntu-sunshine/" />
<meta property="og:site_name" content="Yusuke Tsutsumi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-18T07:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Setting up a streaming gaming Ubuntu PC for sunshine/moonlight" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-07-18T07:00:00+00:00","datePublished":"2025-07-18T07:00:00+00:00","description":"Setting up a streaming gaming Ubuntu PC for moonlight","headline":"Setting up a streaming gaming Ubuntu PC for sunshine/moonlight","mainEntityOfPage":{"@type":"WebPage","@id":"https://y.tsutsumi.io/ubuntu-sunshine/"},"url":"https://y.tsutsumi.io/ubuntu-sunshine/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://y.tsutsumi.io/feed/index.xml" title="Yusuke Tsutsumi" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-325KP61WS9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { window.dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-325KP61WS9');
</script>
</head><body><header class="site-header">

    <div class="wrapper"><a class="site-title" rel="author" href="/">Yusuke Tsutsumi</a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
                <span class="menu-icon">
                    <svg viewBox="0 0 18 15" width="18px" height="15px">
                        <path
                            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                    </svg>
                </span>
            </label>

            <div class="trigger">
                <a class="page-link" href="/tag/coding/">Coding Posts</a>
                <a class="page-link"
                    href="https://nbviewer.jupyter.org/github/toumorokoshi/notebooks/tree/master/">Notebooks</a><a class="page-link" href="/resources/">Resources</a><a class="page-link" href="/about/">About Yusuke Tsutsumi</a></div>
        </nav></div>
    <style>
        .gse-control-cse td {
            border: 0;
        }

        td.gsc-input {
            border: 0;
        }

        td.gsc-search-button {
            border: 0;
        }

        table.gsc-input {
            margin-bottom: 0;
        }
    </style>
</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title p-name" itemprop="name headline">Setting up a streaming gaming Ubuntu PC for sunshine/moonlight</h1>
        <p class="post-meta"><time class="dt-published" datetime="2025-07-18T07:00:00+00:00" itemprop="datePublished">
                Jul 18, 2025
            </time></p>
    </header>

    <div class="post-content e-content" itemprop="articleBody">
        <h1 id="setting-up-a-streaming-gaming-ubuntu-pc-for-moonlight">   Setting up a streaming gaming Ubuntu PC for moonlight <a href="#setting-up-a-streaming-gaming-ubuntu-pc-for-moonlight">#</a>   </h1>
                    

<p>I’ve been working on building a new streaming gaming PC (that ordeal I will save
for a future blog post), but in the process I had some difficulties with getting
moonlight set up just the way I like it. So I figured these might be helpful to
others.</p>

<p>My goal is to have a PC that I use exclusively for streaming games via
<a href="https://app.lizardbyte.dev/Sunshine/?lng=en-US">sunshine</a>. Sunshine is the
replacement for Nvidia game streaming that was deprecated, and work as a
complement to the streaming client <a href="https://moonlight-stream.org/">moonlight</a>.
It allows for the streaming of video and audio to a client, which in turn
streams controls (keyboard and / or a controller) back to the server.</p>

<p>When all is said and done, I want what is effectively a box in my closet with
only two things attached: a power cable, and an ethernet cable (for a
low-latency wired connection to my network). I do not want dangling mice,
keyboards or monitors. Just a box that connects to the internet, and is
available for me to stream from.</p>

<p>To accomplish this, I needed a few things:</p>

<ol>
  <li>A way to have a virtual display even if a physical monitor isn’t plugged in.</li>
  <li>A way to login as a user right away (since sunshine needs a valid user).</li>
  <li>A way to have sunshine available when the machine boots.</li>
  <li>A way to wake the machine after it suspends</li>
</ol>
                <h2 id="attaching-a-virtual-display">   Attaching a virtual display <a href="#attaching-a-virtual-display">#</a>   </h2>
                    

<p>This was relatively easy!</p>

<p>You can buy a <a href="https://www.google.com/search?q=dummy+plug+hdmi">dummy plug</a> that
you just plug into the GPU. When you’ve got your PC set up, just replace your
actual monitor with that.</p>
                <h2 id="logging-in-right-away">   Logging in right away <a href="#logging-in-right-away">#</a>   </h2>
                    

<p>This one just requires careful setup:</p>

<ol>
  <li>setup autologin in your operating system (varies by distro).</li>
  <li><em>do not</em> use disk encryption.</li>
</ol>

<p>(2) is the major gotcha: if you add disk encryption it’ll ask for your password
every time your computer starts up, which means plugging in a keyboard
every time. you could just leave a keyboard by your computer for this purpose,
but I’ve found I do have to restart my computer from time to time, and making
bringing it back up as easy as pressing a button is a nice usability improvement.</p>
                <h2 id="start-sunshine-when-the-machine-boots">   Start sunshine when the machine boots <a href="#start-sunshine-when-the-machine-boots">#</a>   </h2>
                    

<p>This was pretty hard for me. Normally, this is a matter of installing the
sunshine .deb from the <a href="https://github.com/LizardByte/Sunshine/releases">github
releases</a>, but in my case I had
to use Ubuntu 25.05 for a newer kernel version that supports my AMD GPU. Only
LTS release are supported for sunshine.</p>

<p>For a non-lts release, I found that using the <code class="language-plaintext highlighter-rouge">.appimage</code> worked the best. This
unfortunately didn’t work for me without root, so I had to run sunshine as sudo:</p>

<p><code class="language-plaintext highlighter-rouge">sudo -i PULSE_SERVER=unix:/run/user/$(id -u $whoami)/pulse/native /usr/bin/sunshine</code></p>

<p>(I moved the appimage to /usr/bin/sunshine).</p>

<p>I put this in a script, which I then added as a <a href="https://help.ubuntu.com/stable/ubuntu-help/startup-applications.html.en">startup application</a>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="c"># I had to add a sleep to let the graphical interface completely come up.</span>
<span class="c"># otherwise I would see a black screen.</span>
<span class="nb">sleep </span>10
<span class="nb">exec sudo</span> <span class="nt">-i</span> <span class="nv">PULSE_SERVER</span><span class="o">=</span>unix:/run/user/<span class="si">$(</span><span class="nb">id</span> <span class="nt">-u</span> <span class="nv">$whoami</span><span class="si">)</span>/pulse/native /usr/bin/sunshine
</code></pre></div></div>

<p>This works, but still has some wonkiness:</p>

<ul>
  <li>steam can’t be launched via moonlight because it tries to start it as root.</li>
</ul>
                <h2 id="a-way-to-wake-the-machine-after-it-suspends">   A way to wake the machine, after it suspends <a href="#a-way-to-wake-the-machine-after-it-suspends">#</a>   </h2>
                    

<p>Now you probably don’t want your machine on all the time - instead, you’d want
it to suspend after a reasonable idle time frame, and have the ability to turn
it one when you need it.</p>

<p>I tried a few approach, none of which worked or were reliable (I think something
else was resetting my network configuration):</p>

<ul>
  <li><a href="https://wiki.archlinux.org/title/Wake-on-LAN">adding a rule to /systemd/network</a></li>
  <li>Adding a vanilla systemd unit to run ethtool.</li>
</ul>

<p>Ultimately I landed on the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /lib/systemd/system/wol@.service
[Unit]
Description=Wake-on-lan for %i
# This means run after the network is online, as well
# as after suspension.
After=network-online.target suspend.target

[Service]
Type=oneshot
# something else in my OP keeps setting the WOL settings on the device.
# adding this sleep gave whatever time to configure it's settings, so I could override them.
ExecStartPre=/usr/bin/sleep 10
ExecStart=/sbin/ethtool -s %i wol g

[Install]
# if we run network-online and suspend.target, run this too.
WantedBy=network-online.target suspend.target
</code></pre></div></div>

<p>Installed by:</p>

<p><code class="language-plaintext highlighter-rouge">systemctl enable wol@${ethid}</code></p>

<p>Where <code class="language-plaintext highlighter-rouge">${ethid}</code> is the interface id you can get from <code class="language-plaintext highlighter-rouge">nmcli</code>.</p>
                <h2 id="conclusion">   Conclusion <a href="#conclusion">#</a>   </h2>
                    

<p>And that’s it! Most of it was troubleshooting systemd units. My takeaways are:</p>

<ul>
  <li>try to use systemd units as much as possible. It’s an extremely powerful
system and enables you to start your process with the right sequencing and situations.</li>
  <li>try to use LTS releases of Ubuntu if at all possible. Moonlight installation
has been tricky, and I’m sure other packages only support LTS. I’m looking
forward to upgrading to 2026.04 precisely for this benefit.</li>
</ul>
                <h3 id="why-linux-why-ubuntu">   Why linux? Why ubuntu? <a href="#why-linux-why-ubuntu">#</a>   </h3>
                    

<p>Although not for everyone, I like to use Linux for a few reasons:</p>

<ol>
  <li>Linux distributions don’t to forced updates, thereby allowing gaming
uninterrupted by some malware update.</li>
  <li>Windows has a ton of bloatware and ads.</li>
  <li>Linux is “free” - it doesn’t cost a cent to run it, and distros often work
for years.</li>
  <li>With the work done on <a href="https://www.winehq.org/">wine</a> and
<a href="https://github.com/ValveSoftware/Proton">proton</a>, Windows games run
extremely smooth on Linux now.</li>
</ol>

<p>For Ubuntu, I would go with <a href="https://bazzite.gg/">bazzite</a> for a pure gaming PC,
but as this computer will be the most powerful one I have, I wanted it to have
the option to be more general purpose in case I get the itch to do some real
software development on it (maybe ML or some CPU emulation project).</p>
    </div>

    

    <a class="u-url" href="/ubuntu-sunshine/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
    <data class="u-url" href="/%20/"></data>

    <div class="wrapper">

        <div class="footer-col-wrapper">
            <script async src="https://cse.google.com/cse.js?cx=014358564571565173111:hnnbq4j54cy"></script>
            <div class="gcse-search"></div>
        </div>
        <div class="footer-col-wrapper">
            <div class="footer-col">
                <p class="feed-subscribe">
                    <a href="/feed/index.xml">
                        <svg class="svg-icon orange">
                            <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
                        </svg><span>Subscribe</span>
                    </a>
                </p>
            </div>
            <div class="footer-col">
                <p>My blog on software, productivity, and obsessively optimizing. I work at Google, ex-Zillow. Thoughts my own.</p>
            </div>
        </div>

        <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://bsky.app/profile/y.tsutsumi.io" target="_blank"
    title="bluesky">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#bluesky"></use>
    </svg>
  </a>
</li><li>
  <a rel="me" href="https://github.com/toumorokoshi" target="_blank"
    title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li><li>
  <a rel="me" href="https://www.linkedin.com/in/yusuke-tsutsumi" target="_blank"
    title="linkedin">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li></ul></div>

    </div>
    <script src="https://unpkg.com/mermaid@8.9.3/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({
      startOnLoad: true,
      theme: "default",
    });
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  });
</script>

</footer></body>

</html>
